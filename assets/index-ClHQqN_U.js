import{g as y,b as F}from"./index-CSKqQipk.js";var f={exports:{}},d={exports:{}};const b={},x=Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"})),v=y(x);var m;function I(){if(m)return d.exports;m=1;const l=v,n=async u=>new Promise((i,p)=>{const e=l.request(u,t=>{const r=[];let o=!1;t.on("data",s=>{if(!o&&!String(s).startsWith("/*O_o*/"))return i(null);o=!0,r.push(s)}),t.on("end",()=>{i({ok:!0,text:()=>Buffer.concat(r).toString()})})});e.on("error",p),e.end()});return d.exports=n,d.exports.default=n,d.exports}(function(l){const n=typeof window<"u"&&typeof window.document<"u",u=n?window.fetch:I();class i{constructor(e,t){this.id=e,this.setOption(t)}setOption(e){e?typeof e=="string"?(this.sheetName=e,this.sheetId=this.sheetId||null):typeof e=="object"&&(this.sheetName=e.sheetName||this.sheetName,this.sheetId=e.sheetId||this.sheetId,this.useFormattedDate=e.hasOwnProperty("useFormattedDate")?e.useFormattedDate:this.useFormattedDate,this.useFormat=e.hasOwnProperty("useFormat")?e.useFormat:this.useFormat):(this.sheetName=this.sheetName||null,this.sheetId=this.sheetId||null,this.useFormattedDate=this.useFormattedDate||!1,this.useFormat=this.useFormat||!1)}isDate(e){return e&&typeof e=="string"&&/Date\((\d+),(\d+),(\d+)\)/.test(e)}async getSpreadsheetDataUsingFetch(){if(!this.id)return null;let e=`https://docs.google.com/spreadsheets/d/${this.id}/gviz/tq?`;e+=this.sheetId?`gid=${this.sheetId}`:`sheet=${this.sheetName}`;try{const t=await u(e);return t&&t.ok?t.text():null}catch(t){return console.error("Error fetching spreadsheet data:",t),null}}normalizeRow(e){return e.map(t=>t&&t.v!==null&&t.v!==void 0?t:{})}applyHeaderIntoRows(e,t){return t.map(({c:r})=>this.normalizeRow(r)).map(r=>r.reduce((o,s,a)=>s.v!==null&&s.v!==void 0?Object.assign(o,{[e[a]]:this.useFormat?s.f||s.v:this.useFormattedDate&&this.isDate(s.v)&&s.f||s.v}):o,{}))}getItems(e){let t=[];try{const r=/google\.visualization\.Query\.setResponse\(({.*})\);/,[o,s]=e.match(r),a=JSON.parse(s);if(a.table.cols.some(({label:h})=>!!h)){const h=a.table.cols.map(({label:c})=>c);t=this.applyHeaderIntoRows(h,a.table.rows)}else{const[h,...c]=a.table.rows,g=this.normalizeRow(h.c).map(w=>w.v);t=this.applyHeaderIntoRows(g,c)}}catch(r){console.error("Error parsing spreadsheet data:",r)}return t}async parse(e,t){if(e&&(this.id=e),t&&this.setOption(t),!this.id)throw new Error("SpreadsheetId is required.");const r=await this.getSpreadsheetDataUsingFetch();return r===null?[]:this.getItems(r)}}l.exports=i,l.exports.default=i})(f);var S=f.exports;const R=F(S);export{R as P};
